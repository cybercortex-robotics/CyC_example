// Copyright (c) 2025 CyberCortex Robotics SRL. All rights reserved
// Author: Sorin Mihai Grigorescu

Core:
{
    ID                  = 1
    BasePath            = ".."
    StartupFiltersView  = []
    Filters             = "bin/filters"
    LogFile             = "logs/example.log"
    ReplayDB            = "/home/sorin/data/rgbd/icdt_l6_01"
}
Filters =
{
    DataChannel:
    {
        ID              = 1000
        Active          = True
        Type            = "CyC_COM_DATACHANNEL_FILTER_TYPE"
        InputSources    = (
                            {FilterID = 1, Description = "Camera"},
                            {FilterID = 2, Description = "Segmentation"},
                            {FilterID = 3, Description = "SensingViz"},
                            {FilterID = 20, Description = "Drone terminal"},
                            {FilterID = 50, Description = "Vehicle terminal"},
                            {FilterID = 201, Description = "VehicleViz"},
                            {FilterID = 300, Description = "Octoviz"}
                          )
        dt              = 0.001
        dt_Sequencing   = 0.1
        Parameters      = (
                            {name="signaling_uri", value="wss://sig.cybercortex.ai:1920"},
                            {name="user", value="sg@cybercortex.ai"},
                            {name="token",  value="de85f3517053c16a18b2b3110de4e2179818c845"}
                          )
    }
    Camera:
    {
        ID              = 1
        Active          = True
        Type            = "CyC_CAMERA_FILTER_TYPE"
        IsNetworkFilter = False
        IsPublishable   = True
        ReplayFromDB    = False
        dt              = 0.03
        dt_Sequencing   = 0.1
        InputSources    = ()
        Parameters      = ({name = "interface", value = "sim"},
                           {name = "CalibrationFile", value = "etc/calibration/cam_usb.cal"},
                           {name = "Rectify", value = "False"})
    }
    Segmentation:
    {
        ID              = 2
        Active          = True
        Type            = "CyC_BINARY_SEGMENTATION_FILTER_TYPE"
        IsNetworkFilter = False
        IsPublishable   = True
        ReplayFromDB    = False
        dt              = 0.03
        dt_Sequencing   = 0.1
        InputSources    = (
                            {CoreID = 1, FilterID = 1, Description = "Cam 1"}
                          )
        Parameters      = ()
    }
    Map:
    {
        ID              = 47
        Active          = True
        Type            = "CyC_MAP_FILTER_TYPE"
        IsPublishable   = True
        ReplayFromDB    = False
        dt              = 0.1
        dt_Sequencing   = 0.1
        InputSources    = ()
        Parameters      = (
                            {name = "resolution", value = "0.25"},
                            {name = "accumulate", value = "False"}
                          )
    }
    Terminal_AerialDrone:
    {
        ID		        = 20
        Active		    = True
        Type		    = "CyC_TERMINAL_DRONE_FILTER_TYPE"
        IsNetworkFilter = True
        IsPublishable   = True
        ReplayFromDB    = False
        dt              = 0.05
        dt_Sequencing   = 0.1
        InputSources	= ({CoreID=10000, FilterID=20, Description="Browser"})
        Parameters		= ()
    }
    Terminal_GroundVehicle:
    {
        ID              = 50
        Active          = True
        Type            = "CyC_TERMINAL_VEHICLE_FILTER_TYPE"
        IsNetworkFilter = True
        IsPublishable   = True
        ReplayFromDB    = False
        dt              = 0.1
        dt_Sequencing   = 0.1
        InputSources    = ({CoreID=10000, FilterID=50, Description="Browser"})
        Parameters      = (
                            {name = "default_cmd", value = "stop"},
                            {name = "destinations", value = "{[2.0, -2.0, 0.0], Workbench}; {[-8.0, 4.0, 0.0], Loading area}"}
                          )
    }
    Waypoints_Drone:
    {
        ID				= 30
        Active			= True
        Type			= "CyC_WAYPOINTS_FILTER_TYPE"
        IsNetworkFilter = False
        IsPublishable   = True
        ReplayFromDB    = False
        dt              = 0.05
        dt_Sequencing   = 0.1
        InputSources	= ({FilterID = 20, Description = "Drone terminal"})
        Parameters		= ({name = "waypoints_map", value = "etc/missions/markers_map.csv"})
    }
    LocalPlanner:
    {
        ID		        = 35
        Active		    = True
        Type		    = "CyC_LOCAL_PLANNER_FILTER_TYPE"
        IsNetworkFilter = False
        IsPublishable   = True
        ReplayFromDB    = False
        dt              = 0.05
        dt_Sequencing   = 0.1
        InputSources	= (
                            {FilterID = 30, Description = "Drone waypoints"},
                            {FilterID = 47, Description = "Map"},
                            {FilterID = 34, Description = "Robot state"}
                          )
        Parameters		= ({name = "waypoints_map", value = "etc/missions/markers_map.csv"},
                           {name = "type", value = "blind"},    # blind, cmnst, setg
                           {name = "config.vertex_factor", value = "0.1"},
                           {name = "config.longitudinal_distance", value = "3"},
                           {name = "config.use_spline", value = "true"})
    }
    DroneController:
    {
        ID				= 31
        Active			= True
        Type			= "CyC_DRONE_CONTROL_FILTER_TYPE"
        IsPublishable	= True
        ReplayFromDB	= False
        dt              = 0.1
        InputSources	= (
                            {FilterID = 20, Description = "Drone terminal"},
                            {FilterID = 35, Description = "Local planner"},
                            {FilterID = 34, Description = "Drone state estimation"},
                            {FilterID = 47, Description = "Map"}
                          )
        Parameters		= (
                            {name = "drone_model", value = "etc/kinematics/ar_drone_2.conf"},
                            {name = "ControllerType", value = "pid"} # manual, pid, dwa, position
                          )
    }
    DroneSim:
    {
        ID              = 34
        Active          = True
        Type            = "CyC_DRONE_SIMULATION_FILTER_TYPE"
        IsPublishable   = False
        ReplayFromDB    = False
        dt              = 0.001
        InputSources    = (
                            {FilterID = 31, Description = "Drone actuator"}
                          )
        Parameters      = (
                            {name = "drone_model", value = "etc/kinematics/ar_drone_2.conf"},
                            {name = "initial_state", value="0,0,0,0"},
                            {name = "waypoints_map", value = "etc/missions/markers_map.csv"}
                          )
    }
    Waypoints_Vehicle:
    {
        ID              = 49
        Active          = True
        Type            = "CyC_WAYPOINTS_FILTER_TYPE"
        IsPublishable   = False
        ReplayFromDB    = False
        dt              = 0.1
        InputSources    = (
                            {FilterID = 50, Description = "Vehicle terminal"},
                            {FilterID = 54, Description = "Robot state / pose"}
                          )
        Parameters      = (
                            {name = "waypoints_map", value = "etc/missions/dynamic_mission.csv"}
                          )
    }
    VehicleController:
    {
        ID              = 52
        Active          = True
        Type            = "CyC_VEHICLE_CONTROL_FILTER_TYPE"
        IsPublishable   = False
        ReplayFromDB    = False
        dt              = 0.2
        dt_Sequencing   = 0.1
        InputSources    = (
                            {FilterID = 47, Description = "Map"},
                            {FilterID = 49, Description = "Vehicle waypoints"},
                            {FilterID = 54, Description = "Vehicle state estimation"}
                          )
        Parameters      = (
                            {name = "ControllerType", value = "dwa"},   # manual, PP, MPC, LQR, skid, dwa
                            {name = "vehicle_model", value = "etc/kinematics/vehicle_scout.conf"},
                            {name = "ReferenceSpeed", value = "0.3"},
                            {name = "LookaheadDistance", value = "1.0"},
                            {name = "goal_distance", value = "0.75"}
                          )
    }
    VehicleActuator:
    {
        ID              = 53
        Active          = True
        Type            = "CyC_VEHICLE_ACTUATOR_FILTER_TYPE"
        IsPublishable   = True
        ReplayFromDB    = False
        dt              = 0.001
        InputSources    = (
                            {FilterID = 50, Description = "Vehicle terminal"},
                            {FilterID = 52, Description = "Vehicle controller"}
                          )
        Parameters      = (
                            {name = "interface", value = "sim"},            # sim, unity, scout
                            {name = "device_name", value="/dev/ttyUSB0"},   # for scout
                            {name = "ip", value = "127.0.0.1"},
                            {name = "port", value = "2003"}
                          )
    }
    VehicleSim:
    {
        ID              = 54
        Active          = True
        Type            = "CyC_VEHICLE_SIMULATION_FILTER_TYPE"
        IsPublishable   = True
        ReplayFromDB    = False
        dt              = 0.001
        InputSources    = (
                            {FilterID = 53, Description = "Vehicle controller"}
                          )
        Parameters      = (
                            {name = "vehicle_model", value = "etc/kinematics/vehicle_scout.conf"},
                            {name = "initial_state", value="-8.0, 0.0, 0.0, 0.0, 0.0"}
                          )
    }
    SensingViz:
    {
        ID              = 200
        Active          = False
        Type            = "CyC_VIZ_SENSING_FILTER_TYPE"
        IsNetworkFilter = False
        IsPublishable   = True
        ReplayFromDB    = False
        dt              = 0.1
        dt_Sequencing   = 0.1
        InputSources    = (
                            {CoreID = 1, FilterID = 1, Description = "Cam 1"},
                            {CoreID = 1, FilterID = 2, Description = "Segmentation"}
                          ) 
        Parameters      = (
                            {name = "object_classes", value = "etc/env/object_classes_ms_coco.conf"},
                            {name = "gray_viz", value = "True"},
                            {name = "width", value = "1000"},
                            {name = "height", value = "580"},
                            {name = "bew_scale", value = "75"}
                          )
    }
    VehicleViz:
    {
        ID              = 201
        Active          = True
        Type            = "CyC_VIZ_VEHICLE_FILTER_TYPE"
        IsNetworkFilter = False
        IsPublishable   = True
        ReplayFromDB    = False
        dt              = 0.1
        dt_Sequencing   = 0.1
        InputSources    = (
                            {FilterID = 47, Description = "Map"},
                            {FilterID = 30, Description = "Waypoints"},
                            {FilterID = 52, Description = "Vehicle controller"},
                            {FilterID = 34, Description = "Drone state estimation"},
                            {FilterID = 54, Description = "Vehicle state estimation"}
                          )
        Parameters      = (
                            #{name = "voxels", value = "etc/env/voxels.csv"},
                            {name = "main_vehicle", value = "1-54"}
                          )
    }
    Octoviz:
    {
        ID              = 300
        Active          = False
        Type            = "CyC_VIZ_OCTOVIZ_FILTER_TYPE"
        IsNetworkFilter = False
        IsPublishable   = True
        ReplayFromDB    = False
        dt              = 0.1
        dt_Sequencing   = 0.1
        InputSources    = (
                            {FilterID = 30, Description = "Drone waypoints"},
                            {FilterID = 34, Description = "Drone state"},
                            {FilterID = 47, Description = "Map"},
                            {FilterID = 49, Description = "Vehicle waypoints"},
                            {FilterID = 54, Description = "Vehicle state"}
                          ) 
        Parameters      = () #{name = "world_coord", value = "54"})
    }
}
